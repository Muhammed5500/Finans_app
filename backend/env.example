# =============================================================================
# FINANS BACKEND - ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and update values as needed:
#   cp env.example .env
#
# For local development with Docker:
#   - DATABASE_URL uses "localhost" if running outside Docker
#   - DATABASE_URL uses "db" if running inside Docker container
# =============================================================================

# =============================================================================
# DATABASE (Required)
# =============================================================================
# Local development (outside Docker):
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/finans_backend?schema=public
# Inside Docker container:
# DATABASE_URL=postgresql://postgres:postgres@db:5432/finans_backend?schema=public

# =============================================================================
# REDIS & JOB SCHEDULING
# =============================================================================
# Use Redis-based BullMQ for job scheduling (true) or fallback to cron (false)
USE_REDIS_QUEUE=false
# Local development:
REDIS_URL=redis://localhost:6379
# Inside Docker container:
# REDIS_URL=redis://redis:6379

# =============================================================================
# SERVER
# =============================================================================
PORT=3001
NODE_ENV=development
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# =============================================================================
# RATE LIMITING (Public API)
# =============================================================================
# Requests per time window
THROTTLE_TTL=60000
THROTTLE_LIMIT=120

# =============================================================================
# INGESTION - GDELT
# =============================================================================
GDELT_ENABLED=true
GDELT_INTERVAL_MINUTES=3
# Comma-separated list of search queries
GDELT_QUERIES=Tesla,Fed,BTC,SP500,Apple,Microsoft,AAPL,TSLA

# =============================================================================
# INGESTION - SEC RSS
# =============================================================================
SEC_RSS_ENABLED=true
SEC_RSS_INTERVAL_MINUTES=15
# Comma-separated RSS/Atom feed URLs (leave empty for defaults)
# Default feeds:
#   - https://www.sec.gov/cgi-bin/browse-edgar?action=getcurrent&type=&company=&owner=include&count=100&output=atom
#   - https://www.sec.gov/cgi-bin/browse-edgar?action=getcurrent&type=8-K&company=&owner=include&count=100&output=atom
SEC_RSS_FEEDS=

# =============================================================================
# APPLICATION
# =============================================================================
# User-Agent header for SEC requests (SEC requires descriptive UA)
# Format: AppName/Version (contact email)
APP_UA=FinansTakip/1.0 (contact@example.com)

# =============================================================================
# INGESTION - KAP (Kamuyu AydÄ±nlatma Platformu)
# =============================================================================
KAP_ENABLED=true
KAP_INTERVAL_MINUTES=3
# Base URL for KAP
KAP_BASE_URL=https://www.kap.org.tr
# Query path (discover from browser Network tab - see docs/kap.md)
KAP_QUERY_PATH=
# HTTP method: GET or POST
KAP_METHOD=POST
# Request headers (JSON)
KAP_HEADERS={"Content-Type":"application/json"}
# Request body for POST (JSON)
KAP_BODY={}
# Query params for GET (JSON)
KAP_QUERY_PARAMS=
# Response type: json, html, or auto
KAP_RESPONSE_TYPE=auto

# =============================================================================
# INGESTION - GOOGLE NEWS RSS (Optional)
# =============================================================================
# Feature flag to enable/disable Google News RSS collector
ENABLE_GOOGLE_NEWS_RSS=false
# Comma-separated list of search queries
GOOGLE_NEWS_QUERIES=BIST,TUPRS,BTC,SP500,Tesla,Fed
# Language/locale settings (English)
GOOGLE_NEWS_HL=en-US
GOOGLE_NEWS_GL=US
GOOGLE_NEWS_CEID=US:en
# For Turkish news:
# GOOGLE_NEWS_HL=tr
# GOOGLE_NEWS_GL=TR
# GOOGLE_NEWS_CEID=TR:tr

# =============================================================================
# HTTP CLIENT SETTINGS
# =============================================================================
# Request timeout in milliseconds (8 seconds recommended)
HTTP_TIMEOUT_MS=8000
# Maximum concurrent requests per host
HTTP_MAX_CONCURRENT=5
# Minimum time between requests to same host (ms)
HTTP_MIN_TIME_MS=200
# Number of retry attempts for failed requests
HTTP_RETRY_COUNT=3
# Response cache TTL in milliseconds (5 minutes)
HTTP_CACHE_TTL_MS=300000

# =============================================================================
# CIRCUIT BREAKER SETTINGS
# =============================================================================
# Number of consecutive failures before opening circuit
CIRCUIT_BREAKER_THRESHOLD=5
# Time in ms to wait before attempting recovery (30 minutes)
CIRCUIT_BREAKER_RECOVERY_MS=1800000

# =============================================================================
# CACHE SETTINGS
# =============================================================================
# Default cache TTL in milliseconds (1 minute)
CACHE_TTL_MS=60000
# Maximum number of cache entries
CACHE_MAX_SIZE=1000
